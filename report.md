# Отчёт по проекту

## 1. Введение

### Сервис предсказания стоимости недвижимости в Москве

Цель проекта — разработать систему предсказания стоимости недвижимости в Москве с использованием методов машинного обучения. Основные задачи:

- Достичь высокой точности прогнозирования стоимости объектов недвижимости.
- Реализовать интеграцию с Telegram-ботом для удобного взаимодействия с пользователями.

Пользователь может получить прогноз, указав ключевые характеристики объекта: площадь, количество комнат, местоположение и другие параметры.

---

## 2. Команда проекта

- **Куратор:** Александр Чуприн — tg: @Chew13
- **Участник 1:** Антон Кузьмин — tg: @onleepa, GitHub: [onleep](https://github.com/onleep)
- **Участник 2:** Семён Черемисин — tg: @samhook, GitHub: [krabat7](https://github.com/krabat7)
- **Участник 3:** Алексей Урсулян — tg: @GreatPopka, GitHub: [GreatPopka](https://github.com/GreatPopka)
- **Участник 4:** Георгий Лавренов — tg: @goga1899, GitHub: [glavrenov124](https://github.com/glavrenov124)

---

## 3. Описание набора данных

В репозитории содержится несколько файлов, описывающих структуру данных по недвижимости:

- **dataset.md:** Описание структуры данных и информация о наборе данных.
- **EDA.md:** Выводы и описание работы над этапами разведочного анализа данных (EDA).
- **ocenomet_eda.ipynb:** Основной файл с EDA.
- **correlation_matrix.html:** Корреляционная матрица всего датасета.
- **model.ipynb:** Ноутбук для построения и обучения модели машинного обучения.
- **model.md:** Документация модели, описание её и параметров.
- **model.pickle:** Сериализованная модель в формате pickle для дальнейшего использования.

---

## 4. Структура базы данных

- **addresses:** Информация об адресах объектов недвижимости.
- **developers:** Данные о застройщиках.
- **offers:** Информация о предложениях по недвижимости.
- **offers_details:** Детализированная информация об объявлениях продажи недвижимости.
- **realty_details:** Детализированная информация о недвижимости.
- **realty_inside:** Внутренние характеристики объектов недвижимости.
- **realty_outside:** Внешние характеристики объектов недвижимости.

---

## 5. Функционал API и пример использования

### 5.1. Получение параметров объекта недвижимости

Для получения параметров объекта из объявления на ЦИАН отправляется запрос:
```
GET /getparams?url=<ссылка-на-объект>
```

где `url` — ссылка на страницу объекта на платформе ЦИАН.

**Пример кода (Python):**

```python
import httpx

url = 'https://www.cian.ru/sale/flat/294517249/'
getparams = httpx.get('http://<server-address>/api/getparams', params={'url': url}, timeout=120)

print(getparams.status_code)
print(getparams.json())
```

**Пример результата запроса:**

```
200
{
    "cian_id": 294517249,
    "deal_type": "sale",
    "flat_type": "rooms",
    "description": "Продаётся видовая квартира (выходит на 3 стороны) в минуте хотьбы от м.Юго-Западная, в современном монолитно-кирпичном доме...",
    "total_area": 67.0,
    "living_area": 35.0,
    "kitchen_area": 12.0,
    "floor_number": 23,
    "floors_count": 27,
    "price": 33000000.0,
    "metro": "Юго-Западная",
    "travel_time": 4,
    "coordinates": {
        "lat": 55.663349,
        "lng": 37.478729
    }
}
```

### 5.2. Получение предсказания стоимости

После получения параметров недвижимости можно запросить предсказание стоимости, отправив их методом POST на эндпоинт:
```
POST /predict
```
Тело запроса должно содержать JSON с параметрами объекта (например, теми, что вернулись на первом шаге).

**Пример кода (Python):**

```python
price = httpx.post('http://<server-address>/api/predict', json={'data': getparams.json()})
print(price.status_code)
print(price.text)
```

**Пример результата:**

```
200
{
    "price": 27253739.08660581
}
```

Значение `price` — предсказанная стоимость объекта в рублях.

---

## 6. Streamlit-приложение для предсказания стоимости недвижимости

Вы можете попробовать приложение [здесь](https://ocenomet2.streamlit.app/).

Для удобства взаимодействия с моделью было создано веб-приложение на Streamlit. Оно предоставляет два режима работы:

1. Прогноз стоимости по ссылке на объявление.
2. Прогноз стоимости по введённым пользователем параметрам.

**Пример интерфейса приложения:**

### Скриншоты интерфейса

#### Главный экран и выбор режима работы
![image](https://github.com/user-attachments/assets/607f1196-90f8-4cfb-b8b2-55a1f1d2f03e)


#### Отображение данных о недвижимости и сравнение с рынком
![image](https://github.com/user-attachments/assets/028f4b2a-2e67-4988-a605-325a79b87980)


#### Графики распределения стоимости
![image](https://github.com/user-attachments/assets/07dca416-a711-43cf-af7c-1430cbb2becc)

#### Взаимосвязь общей площади к стоимости 
![image](https://github.com/user-attachments/assets/408e2ffa-db4b-4a3e-b573-0f16ce371b6a)

#### Распределение по количеству комнат
![image](https://github.com/user-attachments/assets/1a3fc04f-9960-4670-8899-ee2e8088daf2)

#### Средняя стоимость по округам
![image](https://github.com/user-attachments/assets/15daa0a2-12b5-43bd-82de-1a9987a1bc9d)

#### Карта местоположения и результаты прогноза
![image](https://github.com/user-attachments/assets/fdd23f87-3b9c-4460-8c37-86c9c6dc7e8a)

## 7. Режим прогнозирования по своим параметрам

Второй режим работы приложения позволяет пользователю самостоятельно указать параметры недвижимости для получения прогноза стоимости. Данный режим включает:

- Выбор основных характеристик недвижимости: площадь, количество комнат, тип квартиры, тип ремонта.
- Указание местоположения: район, ближайшее метро, расстояние до центра города.
- Характеристики дома: год постройки, этаж, материал дома, количество этажей.
- Транспортная доступность: способ передвижения и время до метро.

### Скриншоты интерфейса

#### Ввод параметров квартиры
![image](https://github.com/user-attachments/assets/2d5f97f9-008e-4bf0-b854-c5f128f8e8d2)

#### Ввод параметров дома
![image](https://github.com/user-attachments/assets/addc81b2-0683-46bd-ac31-f7b3f51abd48)


#### Анализ введённых данных
![image](https://github.com/user-attachments/assets/cc4b46d0-74e9-4363-ab5c-2f673014f1e9)

#### Графики взаимосвязей и распределения
![image](https://github.com/user-attachments/assets/58e12ea8-ef95-4a78-9a33-4332af8d3adb)


#### Итоговые результаты прогнозирования
![image](https://github.com/user-attachments/assets/0f340bb7-ac10-431a-91d3-eee90f5ae25e)


